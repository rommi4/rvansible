<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with a_gadelshin@wargaming.net at Tue 17 Feb 2015 12:21:10 PM MSK on r_verenich@wargaming.net/ (jabber)</title></head><body><h3>Conversation with a_gadelshin@wargaming.net at Tue 17 Feb 2015 12:21:10 PM MSK on r_verenich@wargaming.net/ (jabber)</h3>
<font color="#16569E"><font size="2">(12:24:22 PM)</font> <b>Roman Verenich:</b></font> Артур, привет!<br/><br/>если есть пару минут - глянь плз<br/>eu5-wows-localization-db-1.wargaming.net<br/><br/><span style='color: #333333;'><span style='font-size: medium;'><span style='font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;'>Could not retrieve catalog from remote server: Error 400 on SERVER: Duplicate declaration: Class[Wg::Db::Mysql_config] is already declared in file /etc/puppet/modules/wg/manifests/db.pp:487; cannot redeclare at /etc/puppet/modules/wg/manifests/db.pp:441 on node eu5-wows-localization-db-1.wargaming.net</span></span></span><span style='font-size: medium;'><br/><br/>manifests/clusters/eu5.pp <br/>410 node 'eu5-wows-localization-db-1.wargaming.net' inherits 'eu5wowslo' {<br/>411   include wg::db::percona<br/>412   include wg::profiles::db_xmppcs<br/>413 }<br/><br/>hieradata/node/eu5/eu5-wows-localization-db-1.wargaming.net.json<br/>  1 {<br/>  2   &quot;wg::profiles::db_xmppcs::databases&quot;: [&quot;common&quot;, &quot;router&quot;, &quot;roster&quot;],<br/>  3   &quot;database::xmppcs::router::id&quot;: [&quot;01&quot;],<br/>  4   &quot;database::xmppcs::roster::id&quot;: [&quot;01&quot;],<br/>  5   &quot;database::xmppcs::realm::id&quot;: &quot;wowslo1&quot;<br/>  6 }<br/><br/><br/><br/>в db.pp:<br/>436   class { 'wg::db::mysql_config':<br/>437     config         =&gt; $config,<br/>438     use_tpl        =&gt; $use_mysql_tpl,<br/>439     mysql_version  =&gt; $mysql_version,<br/>440     replace_config =&gt; $replace_config,<br/>441   }<br/><br/>482   class { 'wg::db::mysql_config':<br/>483     config         =&gt; $config,<br/>484     use_tpl        =&gt; 'mysql55',<br/>485     mysql_version  =&gt; $mysql_version,<br/>486     replace_config =&gt; $replace_config,<br/>487   }</span><br/><br/><br/>PS не накатывается  wg::db::percona + db_xmppc<br/>комбинация ниже успешно:<br/>2733 node 'fr2-v-st21-db1.wargaming.net' inherits fr2node {<br/>2734   include wg::bwdb<br/>2735   include wg::profiles::db_xmppcs<br/>2736 }<br/><br/>мб лучше не париться и руками в eu5-wows-localization-db-1 все прописать?<br/>
<font color="#A82F2F"><font size="2">(12:25:03 PM)</font> <b>Artur Gadelshin:</b></font> а зачем ты их вместе юзаешь?<br/>
<font color="#A82F2F"><font size="2">(12:25:19 PM)</font> <b>Artur Gadelshin:</b></font> db_xmppcs уже включает в себя wg::db::percona56<br/>
<font color="#A82F2F"><font size="2">(12:25:37 PM)</font> <b>Artur Gadelshin:</b></font> и bwdb включает в себя wg::db::percona56<br/>
<font color="#A82F2F"><font size="2">(12:25:43 PM)</font> <b>Artur Gadelshin:</b></font> и на 1 хост они отлично приходят, да<br/>
<font color="#A82F2F"><font size="2">(12:25:58 PM)</font> <b>Artur Gadelshin:</b></font> или у тебя уже был wg::db::percona?<br/>
<font color="#16569E"><font size="2">(12:26:20 PM)</font> <b>Roman Verenich:</b></font> уже был, я только db_xmppcs добавил<br/>
<font color="#A82F2F"><font size="2">(12:26:41 PM)</font> <b>Artur Gadelshin:</b></font> :))<br/>
<font color="#A82F2F"><font size="2">(12:26:54 PM)</font> <b>Artur Gadelshin:</b></font> тогда потестируй переход с wg::db::percona на wg::db::percona56<br/>
<font color="#A82F2F"><font size="2">(12:26:59 PM)</font> <b>Artur Gadelshin:</b></font> или создавай базы руками<br/>
<font color="#A82F2F"><font size="2">(12:27:05 PM)</font> <b>Artur Gadelshin:</b></font> <html xmlns='http://jabber.org/protocol/xhtml-im'><body xmlns='http://www.w3.org/1999/xhtml'><p><a href="https://confluence.wargaming.net/display/WOTDB/Default+database+users+for+Jabber+Daemon">https://confluence.wargaming.net/display/WOTDB/Default+database+users+for+Jabber+Daemon</a></p></body></html><br/>
<font color="#16569E"><font size="2">(12:27:24 PM)</font> <b>Roman Verenich:</b></font> хорошо<br/>спасибо!<br/>
<font color="#16569E"><font size="2">(04:15:16 PM)</font> <b>Roman Verenich:</b></font> Артур, подскажи плз откуда берутся эти параметры в local.xml wg/xmpp:<br/>    &lt;admin&gt;<br/>        &lt;user&gt;admin&lt;/user&gt;<br/>        &lt;password&gt;Pa$$W0RD&lt;/password&gt;<br/>        &lt;host&gt;admin.${DOMAIN}&lt;/host&gt;<br/>
<font color="#A82F2F"><font size="2">(04:15:28 PM)</font> <b>Artur Gadelshin:</b></font> нужно создавать админа в базе<br/>
<font color="#A82F2F"><font size="2">(04:15:29 PM)</font> <b>Artur Gadelshin:</b></font> ручками<br/>
</body></html>
